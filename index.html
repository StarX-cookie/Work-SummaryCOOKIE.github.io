<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>少年特工 - 密码工具集</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', sans-serif;
            background-color: #1a1f0d;
            color: #d4c9a9;
            line-height: 1.6;
            min-height: 100vh;
            overflow-x: hidden;
            background-image: 
                radial-gradient(circle at 20% 30%, rgba(58, 68, 18, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 70%, rgba(88, 98, 38, 0.2) 0%, transparent 50%);
            position: relative;
        }
        
        body::before {
            content: "";
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" opacity="0.05"><rect fill="%23d4c9a9" width="100" height="100"/></svg>');
            background-size: 20px 20px;
            z-index: -1;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            z-index: 1;
        }
        
        header {
            text-align: center;
            margin-bottom: 40px;
            width: 100%;
        }
        
        h1 {
            font-size: 3.5rem;
            color: #e8dfb9;
            text-transform: uppercase;
            letter-spacing: 4px;
            text-shadow: 
                0 0 10px rgba(232, 223, 185, 0.5),
                2px 2px 4px rgba(0, 0, 0, 0.8),
                4px 4px 0 #8a7c3d;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
            padding: 0 20px;
        }
        
        h1::before, h1::after {
            content: "";
            position: absolute;
            top: 50%;
            width: 30px;
            height: 4px;
            background: linear-gradient(to right, transparent, #d4c9a9, transparent);
        }
        
        h1::before {
            left: 0;
        }
        
        h1::after {
            right: 0;
        }
        
        .subtitle {
            font-size: 1rem;
            color: #9e9466;
            font-style: italic;
            letter-spacing: 1px;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.8;
        }
        
        .buttons-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            margin-top: 30px;
            width: 100%;
            max-width: 900px;
        }
        
        .btn {
            flex: 1 1 45%;
            min-width: 0;
            padding: 20px 15px;
            background: linear-gradient(145deg, #2a2f15, #1a1f0d);
            border: 2px solid #5a5a2a;
            color: #d4c9a9;
            font-family: inherit;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.4s;
            text-transform: uppercase;
            letter-spacing: 1px;
            position: relative;
            overflow: hidden;
            box-shadow: 
                0 4px 8px rgba(0, 0, 0, 0.3),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
        }
        
        .btn::before {
            content: "";
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(212, 201, 169, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn:hover {
            transform: translateY(-5px);
            border-color: #d4c9a9;
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.4),
                0 0 20px rgba(212, 201, 169, 0.2),
                inset 0 1px 0 rgba(255, 255, 255, 0.1);
            color: #f0e6c3;
        }
        
        .btn:hover::before {
            left: 100%;
        }
        
        .btn-icon {
            display: block;
            font-size: 2rem;
            margin-bottom: 10px;
            color: #9e9466;
            transition: color 0.3s;
        }
        
        .btn:hover .btn-icon {
            color: #d4c9a9;
        }
        
        .btn-description {
            font-size: 0.8rem;
            color: #9e9466;
            margin-top: 8px;
            font-weight: normal;
            text-transform: none;
            letter-spacing: 0.5px;
            line-height: 1.4;
            transition: color 0.3s;
        }
        
        .btn:hover .btn-description {
            color: #d4c9a9;
        }
        
        .tool-container {
            display: none;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background-color: #2a2f15;
            border: 2px solid #5a5a2a;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .tool-container.active {
            display: block;
        }
        
        .tool-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #5a5a2a;
        }
        
        .tool-title {
            font-size: 1.8rem;
            color: #e8dfb9;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 10px;
        }
        
        .tool-subtitle {
            font-size: 0.9rem;
            color: #9e9466;
            font-style: italic;
        }
        
        .back-btn {
            position: absolute;
            top: 15px;
            left: 15px;
            padding: 8px 12px;
            background-color: #5a5a2a;
            color: #d4c9a9;
            border: 1px solid #9e9466;
            border-radius: 4px;
            cursor: pointer;
            font-family: inherit;
            font-weight: bold;
            font-size: 0.9rem;
            transition: all 0.3s;
            z-index: 10;
        }
        
        .back-btn:hover {
            background-color: #6b6b33;
            transform: translateY(-2px);
        }
        
        /* 摩斯电码样式 */
        .morse-input-section {
            margin-bottom: 20px;
        }
        
        .morse-input-group {
            margin-bottom: 15px;
        }
        
        .morse-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #b8ad80;
            font-size: 0.9rem;
        }
        
        .morse-input {
            width: 100%;
            padding: 10px;
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            color: #d4c9a9;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            border-radius: 3px;
            margin-bottom: 10px;
        }
        
        .morse-input:focus {
            outline: none;
            border-color: #d4c9a9;
            box-shadow: 0 0 5px rgba(212, 201, 169, 0.5);
        }
        
        .morse-output {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 12px;
            min-height: 50px;
            font-size: 1.2rem;
            letter-spacing: 2px;
            margin-bottom: 15px;
            border-radius: 3px;
            color: #f0e6c3;
            text-shadow: 0 0 5px rgba(240, 230, 195, 0.3);
            word-break: break-all;
        }
        
        .morse-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .morse-btn {
            flex: 1;
            min-width: 120px;
            padding: 10px;
            background-color: #5a5a2a;
            color: #d4c9a9;
            border: 1px solid #9e9466;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .morse-btn:hover {
            background-color: #6b6b33;
            box-shadow: 0 0 8px rgba(212, 201, 169, 0.3);
        }
        
        .morse-reference {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #5a5a2a;
        }
        
        .morse-reference h2 {
            font-size: 1.2rem;
            color: #d4c9a9;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .morse-reference-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 8px;
        }
        
        .morse-reference-item {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 6px;
            border-radius: 3px;
            text-align: center;
            font-size: 0.8rem;
        }
        
        .morse-char {
            font-weight: bold;
            color: #f0e6c3;
        }
        
        .morse-code {
            color: #9e9466;
            font-size: 0.7rem;
        }
        
        .morse-flash {
            animation: flash 0.5s;
        }
        
        .morse-sound-indicator {
            display: inline-block;
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #5a5a2a;
            margin-left: 8px;
            vertical-align: middle;
        }
        
        .morse-sound-indicator.active {
            background-color: #d4c9a9;
            box-shadow: 0 0 8px #d4c9a9;
        }
        
        /* 凯撒密码样式 */
        .caesar-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #5a5a2a;
            overflow-x: auto;
        }
        
        .caesar-tab {
            padding: 8px 15px;
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            border-bottom: none;
            margin-right: 5px;
            cursor: pointer;
            border-radius: 3px 3px 0 0;
            font-weight: bold;
            font-size: 0.9rem;
            white-space: nowrap;
        }
        
        .caesar-tab.active {
            background-color: #5a5a2a;
            color: #f0e6c3;
        }
        
        .caesar-tab-content {
            display: none;
        }
        
        .caesar-tab-content.active {
            display: block;
        }
        
        .caesar-input-group {
            margin-bottom: 15px;
        }
        
        .caesar-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #b8ad80;
            font-size: 0.9rem;
        }
        
        .caesar-textarea {
            width: 100%;
            padding: 10px;
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            color: #d4c9a9;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border-radius: 3px;
            min-height: 80px;
            resize: vertical;
        }
        
        .caesar-textarea:focus {
            outline: none;
            border-color: #d4c9a9;
            box-shadow: 0 0 5px rgba(212, 201, 169, 0.5);
        }
        
        .caesar-key-input {
            width: 70px;
            text-align: center;
            padding: 8px;
        }
        
        .caesar-output {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 12px;
            min-height: 50px;
            font-size: 1rem;
            letter-spacing: 1px;
            margin-bottom: 15px;
            border-radius: 3px;
            color: #f0e6c3;
            text-shadow: 0 0 5px rgba(240, 230, 195, 0.3);
            white-space: pre-wrap;
            word-break: break-all;
        }
        
        .caesar-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .caesar-btn {
            flex: 1;
            min-width: 120px;
            padding: 10px;
            background-color: #5a5a2a;
            color: #d4c9a9;
            border: 1px solid #9e9466;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .caesar-btn:hover {
            background-color: #6b6b33;
            box-shadow: 0 0 8px rgba(212, 201, 169, 0.3);
        }
        
        .caesar-reference {
            margin-top: 20px;
            padding-top: 15px;
            border-top: 1px solid #5a5a2a;
        }
        
        .caesar-reference h2 {
            font-size: 1.2rem;
            color: #d4c9a9;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .caesar-reference-content {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 12px;
            border-radius: 3px;
            font-size: 0.8rem;
            line-height: 1.5;
        }
        
        .caesar-warning {
            color: #d4a959;
            font-size: 0.7rem;
            margin-top: 5px;
        }
        
        .caesar-flash {
            animation: flash 0.5s;
        }
        
        /* 恩尼格玛机样式 */
        .enigma-rotors-section {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .enigma-rotors-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: #d4c9a9;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .enigma-rotors-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .enigma-rotor {
            background-color: #222;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 10px;
            text-align: center;
            width: 90px;
        }
        
        .enigma-rotor-label {
            font-size: 0.7rem;
            color: #888;
            margin-bottom: 5px;
        }
        
        .enigma-rotor-display {
            background-color: #000;
            border: 1px solid #444;
            padding: 8px;
            font-size: 1.2rem;
            font-weight: bold;
            color: #d4c9a9;
            margin-bottom: 8px;
            border-radius: 3px;
        }
        
        .enigma-rotor-controls {
            display: flex;
            justify-content: space-between;
        }
        
        .enigma-rotor-btn {
            background-color: #333;
            color: #d4c9a9;
            border: 1px solid #555;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
        }
        
        .enigma-rotor-btn:hover {
            background-color: #444;
        }
        
        .enigma-plugboard-section {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .enigma-plugboard-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: #d4c9a9;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .enigma-plugboard {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 8px;
            margin-bottom: 15px;
        }
        
        .enigma-plug {
            display: flex;
            align-items: center;
            gap: 3px;
        }
        
        .enigma-plug-letter {
            background-color: #222;
            border: 1px solid #555;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .enigma-plug-cable {
            width: 20px;
            height: 4px;
            background-color: #555;
        }
        
        .enigma-keyboard-lampboard {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .enigma-lampboard, .enigma-keyboard {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 15px;
            border-radius: 5px;
        }
        
        .enigma-section-title {
            font-size: 1rem;
            margin-bottom: 10px;
            color: #d4c9a9;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .enigma-lamp-grid, .enigma-key-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 6px;
        }
        
        .enigma-lamp, .enigma-key {
            background-color: #222;
            border: 1px solid #555;
            border-radius: 5px;
            padding: 8px 3px;
            text-align: center;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 0.8rem;
        }
        
        .enigma-key:hover {
            background-color: #333;
        }
        
        .enigma-lamp.active {
            background-color: #d4a959;
            color: #000;
            box-shadow: 0 0 10px #d4a959;
        }
        
        .enigma-key.pressed {
            background-color: #555;
            transform: translateY(2px);
        }
        
        .enigma-input-output {
            display: flex;
            flex-direction: column;
            gap: 15px;
            margin-bottom: 15px;
        }
        
        .enigma-input-area, .enigma-output-area {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 15px;
            border-radius: 5px;
        }
        
        .enigma-textarea {
            width: 100%;
            padding: 10px;
            background-color: #000;
            border: 1px solid #444;
            color: #d4c9a9;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border-radius: 3px;
            min-height: 80px;
            resize: vertical;
        }
        
        .enigma-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }
        
        .enigma-btn {
            flex: 1;
            min-width: 120px;
            padding: 10px;
            background-color: #333;
            color: #d4c9a9;
            border: 1px solid #555;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .enigma-btn:hover {
            background-color: #444;
        }
        
        .enigma-history {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 12px;
            margin-top: 15px;
            border-radius: 5px;
            max-height: 120px;
            overflow-y: auto;
        }
        
        .enigma-history-title {
            font-size: 0.9rem;
            margin-bottom: 8px;
            color: #d4c9a9;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .enigma-history-item {
            font-family: 'Courier New', monospace;
            margin-bottom: 4px;
            padding: 4px;
            border-bottom: 1px solid #222;
            font-size: 0.8rem;
        }
        
        .enigma-input-char {
            color: #d4a959;
        }
        
        .enigma-output-char {
            color: #8fbc8f;
        }
        
        .enigma-status {
            text-align: center;
            margin-top: 8px;
            font-size: 0.8rem;
            color: #888;
        }
        
        /* 特工任务样式 */
        .mission-container {
            display: none;
            width: 100%;
            max-width: 1000px;
            margin: 0 auto;
            background-color: #2a2f15;
            border: 2px solid #5a5a2a;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }
        
        .mission-container.active {
            display: block;
        }
        
        .mission-header {
            text-align: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #5a5a2a;
        }
        
        .mission-title {
            font-size: 1.8rem;
            color: #e8dfb9;
            text-transform: uppercase;
            letter-spacing: 3px;
            margin-bottom: 10px;
        }
        
        .mission-subtitle {
            font-size: 0.9rem;
            color: #9e9466;
            font-style: italic;
        }
        
        .mission-tabs {
            display: flex;
            margin-bottom: 15px;
            border-bottom: 1px solid #5a5a2a;
            overflow-x: auto;
        }
        
        .mission-tab {
            padding: 8px 15px;
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            border-bottom: none;
            margin-right: 5px;
            cursor: pointer;
            border-radius: 3px 3px 0 0;
            font-weight: bold;
            font-size: 0.9rem;
            white-space: nowrap;
        }
        
        .mission-tab.active {
            background-color: #5a5a2a;
            color: #f0e6c3;
        }
        
        .mission-tab-content {
            display: none;
        }
        
        .mission-tab-content.active {
            display: block;
        }
        
        .mission-levels-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(80px, 1fr));
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .mission-level {
            background-color: #1a1f0d;
            border: 2px solid #5a5a2a;
            border-radius: 8px;
            padding: 15px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            position: relative;
        }
        
        .mission-level:hover {
            border-color: #d4c9a9;
            transform: translateY(-3px);
        }
        
        .mission-level.completed {
            border-color: #8fbc8f;
            background-color: #1a2f15;
        }
        
        .mission-level.completed::after {
            content: "✓";
            position: absolute;
            top: 5px;
            right: 5px;
            color: #8fbc8f;
            font-weight: bold;
            font-size: 0.8rem;
        }
        
        .mission-level.unlocked {
            border-color: #d4a959;
            background-color: #2f2a15;
        }
        
        .mission-level.locked {
            background-color: #1a1a1a;
            border-color: #333;
            cursor: not-allowed;
            opacity: 0.6;
        }
        
        .mission-level-number {
            font-size: 1.5rem;
            color: #d4c9a9;
            margin-bottom: 8px;
        }
        
        .mission-level-title {
            font-size: 0.7rem;
            color: #9e9466;
        }
        
        .mission-details {
            background-color: #1a1f0d;
            border: 1px solid #5a5a2a;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 15px;
        }
        
        .mission-details-title {
            font-size: 1.2rem;
            color: #e8dfb9;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .mission-details-description {
            color: #d4c9a9;
            margin-bottom: 15px;
            line-height: 1.5;
            font-size: 0.9rem;
        }
        
        .mission-input-group {
            margin-bottom: 15px;
        }
        
        .mission-label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #b8ad80;
            font-size: 0.9rem;
        }
        
        .mission-input {
            width: 100%;
            padding: 10px;
            background-color: #0a0f05;
            border: 1px solid #5a5a2a;
            color: #d4c9a9;
            font-family: 'Courier New', monospace;
            font-size: 0.9rem;
            border-radius: 3px;
        }
        
        .mission-input:focus {
            outline: none;
            border-color: #d4c9a9;
            box-shadow: 0 0 5px rgba(212, 201, 169, 0.5);
        }
        
        .mission-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .mission-btn {
            flex: 1;
            min-width: 120px;
            padding: 10px;
            background-color: #5a5a2a;
            color: #d4c9a9;
            border: 1px solid #9e9466;
            font-family: inherit;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .mission-btn:hover {
            background-color: #6b6b33;
            box-shadow: 0 0 8px rgba(212, 201, 169, 0.3);
        }
        
        .mission-btn:disabled {
            background-color: #333;
            color: #666;
            cursor: not-allowed;
            border-color: #444;
        }
        
        .mission-result {
            margin-top: 15px;
            padding: 12px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            display: none;
            font-size: 0.9rem;
        }
        
        .mission-result.success {
            background-color: rgba(143, 188, 143, 0.2);
            border: 1px solid #8fbc8f;
            color: #8fbc8f;
            display: block;
        }
        
        .mission-result.failure {
            background-color: rgba(188, 143, 143, 0.2);
            border: 1px solid #bc8f8f;
            color: #bc8f8f;
            display: block;
        }
        
        .certificate-container {
            text-align: center;
            padding: 30px 15px;
            background-color: #1a1f0d;
            border: 2px solid #5a5a2a;
            border-radius: 8px;
            margin: 15px 0;
            display: none;
        }
        
        .certificate-container.active {
            display: block;
        }
        
        .certificate-title {
            font-size: 2rem;
            color: #e8dfb9;
            margin-bottom: 15px;
            text-transform: uppercase;
            letter-spacing: 3px;
            text-shadow: 0 0 10px rgba(232, 223, 185, 0.5);
        }
        
        .certificate-subtitle {
            font-size: 1.2rem;
            color: #d4c9a9;
            margin-bottom: 20px;
        }
        
        .certificate-content {
            font-size: 1rem;
            color: #9e9466;
            line-height: 1.6;
            margin-bottom: 20px;
            max-width: 100%;
            margin-left: auto;
            margin-right: auto;
        }
        
        .certificate-seal {
            width: 120px;
            height: 120px;
            border: 3px solid #d4a959;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            color: #d4a959;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .certificate-download {
            padding: 10px 20px;
            background-color: #5a5a2a;
            color: #d4c9a9;
            border: 1px solid #9e9466;
            font-family: inherit;
            font-weight: bold;
            font-size: 0.9rem;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-top: 15px;
        }
        
        .certificate-download:hover {
            background-color: #6b6b33;
            box-shadow: 0 0 8px rgba(212, 201, 169, 0.3);
        }
        
        .progress-bar {
            height: 8px;
            background-color: #1a1f0d;
            border-radius: 4px;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(to right, #5a5a2a, #d4a959);
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .progress-text {
            text-align: center;
            color: #9e9466;
            font-size: 0.8rem;
            margin-bottom: 8px;
        }
        
        /* 通用样式 */
        @keyframes flash {
            0% { background-color: #1a1f0d; }
            50% { background-color: #5a5a2a; }
            100% { background-color: #1a1f0d; }
        }
        
        .military-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            pointer-events: none;
            z-index: -1;
        }
        
        .radar {
            position: absolute;
            top: 10%;
            right: 10%;
            width: 80px;
            height: 80px;
            border: 2px solid #5a5a2a;
            border-radius: 50%;
            opacity: 0.3;
        }
        
        .radar::before {
            content: "";
            position: absolute;
            top: 50%;
            left: 50%;
            width: 8px;
            height: 8px;
            background-color: #9e9466;
            border-radius: 50%;
            transform: translate(-50%, -50%);
        }
        
        .radar::after {
            content: "";
            position: absolute;
            top: 0;
            left: 50%;
            width: 2px;
            height: 50%;
            background: linear-gradient(to bottom, transparent, #9e9466);
            transform-origin: bottom center;
            animation: radar-sweep 4s linear infinite;
        }
        
        @keyframes radar-sweep {
            0% {
                transform: translateX(-50%) rotate(0deg);
            }
            100% {
                transform: translateX(-50%) rotate(360deg);
            }
        }
        
        .code-snippet {
            position: absolute;
            bottom: 10%;
            left: 5%;
            font-family: 'Courier New', monospace;
            font-size: 0.7rem;
            color: #5a5a2a;
            opacity: 0.5;
        }
        
        .binoculars {
            position: absolute;
            bottom: 15%;
            right: 5%;
            width: 60px;
            height: 30px;
            border: 2px solid #5a5a2a;
            border-radius: 50%;
            opacity: 0.3;
        }
        
        .binoculars::before, .binoculars::after {
            content: "";
            position: absolute;
            top: 50%;
            width: 25px;
            height: 25px;
            border: 2px solid #5a5a2a;
            border-radius: 50%;
            transform: translateY(-50%);
        }
        
        .binoculars::before {
            left: 5px;
        }
        
        .binoculars::after {
            right: 5px;
        }
        
        footer {
            margin-top: 40px;
            text-align: center;
            font-size: 0.7rem;
            color: #5a5a2a;
            width: 100%;
            padding: 15px 0;
            border-top: 1px solid #2a2f15;
        }
        
        /* 移动端优化 */
        @media (max-width: 480px) {
            h1 {
                font-size: 2.5rem;
                letter-spacing: 2px;
                padding: 0 15px;
            }
            
            .subtitle {
                font-size: 0.9rem;
                padding: 0 10px;
            }
            
            .buttons-container {
                gap: 15px;
            }
            
            .btn {
                flex: 1 1 100%;
                padding: 15px 10px;
                font-size: 1rem;
            }
            
            .btn-icon {
                font-size: 1.8rem;
            }
            
            .tool-container {
                padding: 15px;
            }
            
            .tool-title {
                font-size: 1.5rem;
                letter-spacing: 2px;
            }
            
            .enigma-rotors-container {
                flex-direction: column;
                align-items: center;
            }
            
            .enigma-rotor {
                width: 100%;
                max-width: 200px;
            }
            
            .mission-levels-grid {
                grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            }
            
            .mission-level {
                padding: 12px 5px;
            }
            
            .mission-level-number {
                font-size: 1.3rem;
            }
            
            .certificate-title {
                font-size: 1.8rem;
            }
            
            .certificate-subtitle {
                font-size: 1.1rem;
            }
            
            .certificate-content {
                font-size: 0.9rem;
            }
            
            .radar, .binoculars {
                display: none;
            }
        }
        
        @media (max-width: 768px) and (min-width: 481px) {
            .btn {
                flex: 1 1 45%;
            }
            
            .enigma-lamp-grid, .enigma-key-grid {
                grid-template-columns: repeat(9, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="military-elements">
        <div class="radar"></div>
        <div class="binoculars"></div>
        <div class="code-snippet">01001101 COOKIE  01101001  COOKIE 01110011 COOKIE  01110011 COOKIE  01101001 COOKIE  01101111 COOKIE  01101110 COOKIE  00100000 COOKIE  01010011  COOKIE 01110100 COOKIE  01100001 COOKIE  01110010 COOKIE  01110100</div>
    </div>
    
    <!-- 主页面 -->
    <div class="container" id="main-page">
        <header>
            <h1>少年特工</h1>
            <p class="subtitle">精英密码工具集 - 专为特工任务设计的加密解密系统</p>
        </header>
        
        <div class="buttons-container">
            <button class="btn" id="morse-btn">
                <span class="btn-icon">— • — •</span>
                摩斯电码
                <div class="btn-description">二战盟军通信密码系统<br>通过点和划传递秘密信息</div>
            </button>
            
            <button class="btn" id="caesar-btn">
                <span class="btn-icon">A → D</span>
                凯撒密码
                <div class="btn-description">古罗马经典替换密码<br>通过字母移位实现加密</div>
            </button>
            
            <button class="btn" id="enigma-btn">
                <span class="btn-icon">A → K</span>
                恩尼格玛机
                <div class="btn-description">德军高级加密设备<br>多转子系统复杂加密</div>
            </button>
            
            <!-- 新增特工任务按钮 -->
            <button class="btn" id="mission-btn">
                <span class="btn-icon">★★★</span>
                特工任务
                <div class="btn-description">18关密码破译挑战<br>完成所有任务获取毕业证书</div>
            </button>
        </div>
        
        <footer>
            <p>少年特工COOKIE密码系统 | 机密等级：最高 | 仅供授权人员使用</p>
        </footer>
    </div>
    
    <!-- 摩斯电码工具 -->
    <div class="tool-container" id="morse-tool">
        <button class="back-btn" id="morse-back-btn">返回</button>
        <div class="tool-header">
            <h2 class="tool-title">摩斯电码转换器</h2>
            <p class="tool-subtitle">二战盟军通信设备模拟器</p>
        </div>
        
        <div class="morse-input-section">
            <div class="morse-input-group">
                <label for="morse-text-input" class="morse-label">输入字母或单词：</label>
                <input type="text" id="morse-text-input" class="morse-input" placeholder="输入文本..." maxlength="30">
                
                <div class="morse-output" id="morse-output">
                    <!-- 摩斯电码将在这里显示 -->
                </div>
                
                <div class="morse-controls">
                    <button class="morse-btn" id="morse-convert-btn">转换</button>
                    <button class="morse-btn" id="morse-play-btn">播放声音 <span class="morse-sound-indicator"></span></button>
                    <button class="morse-btn" id="morse-clear-btn">清除</button>
                </div>
            </div>
        </div>
        
        <div class="morse-reference">
            <h2>摩斯电码参考表</h2>
            <div class="morse-reference-grid" id="morse-reference-grid">
                <!-- 参考表将通过JavaScript生成 -->
            </div>
        </div>
    </div>
    
    <!-- 凯撒密码工具 -->
    <div class="tool-container" id="caesar-tool">
        <button class="back-btn" id="caesar-back-btn">返回</button>
        <div class="tool-header">
            <h2 class="tool-title">凯撒密码转换器</h2>
            <p class="tool-subtitle">古罗马经典替换密码系统</p>
        </div>
        
        <div class="caesar-tabs">
            <div class="caesar-tab active" data-tab="encrypt">加密</div>
            <div class="caesar-tab" data-tab="decrypt">解密</div>
        </div>
        
        <div class="caesar-tab-content active" id="caesar-encrypt-tab">
            <div class="caesar-input-group">
                <label for="caesar-plaintext" class="caesar-label">输入原文：</label>
                <textarea id="caesar-plaintext" class="caesar-textarea" placeholder="输入要加密的文本..."></textarea>
            </div>
            
            <div class="caesar-input-group">
                <label for="caesar-encrypt-key" class="caesar-label">密钥 (1-25)：</label>
                <input type="number" id="caesar-encrypt-key" class="caesar-key-input" min="1" max="25" value="3">
                <p class="caesar-warning">注意：密钥必须是1到25之间的整数</p>
            </div>
            
            <div class="caesar-output" id="caesar-ciphertext-output">
                <!-- 加密结果将在这里显示 -->
            </div>
            
            <div class="caesar-controls">
                <button class="caesar-btn" id="caesar-encrypt-btn">加密</button>
                <button class="caesar-btn" id="caesar-copy-encrypt-btn">复制结果</button>
                <button class="caesar-btn" id="caesar-clear-encrypt-btn">清除</button>
            </div>
        </div>
        
        <div class="caesar-tab-content" id="caesar-decrypt-tab">
            <div class="caesar-input-group">
                <label for="caesar-ciphertext" class="caesar-label">输入密文：</label>
                <textarea id="caesar-ciphertext" class="caesar-textarea" placeholder="输入要解密的文本..."></textarea>
            </div>
            
            <div class="caesar-input-group">
                <label for="caesar-decrypt-key" class="caesar-label">密钥 (1-25)：</label>
                <input type="number" id="caesar-decrypt-key" class="caesar-key-input" min="1" max="25" value="3">
                <p class="caesar-warning">注意：密钥必须是1到25之间的整数</p>
            </div>
            
            <div class="caesar-output" id="caesar-plaintext-output">
                <!-- 解密结果将在这里显示 -->
            </div>
            
            <div class="caesar-controls">
                <button class="caesar-btn" id="caesar-decrypt-btn">解密</button>
                <button class="caesar-btn" id="caesar-copy-decrypt-btn">复制结果</button>
                <button class="caesar-btn" id="caesar-clear-decrypt-btn">清除</button>
            </div>
        </div>
        
        <div class="caesar-reference">
            <h2>凯撒密码参考</h2>
            <div class="caesar-reference-content">
                <p>凯撒密码是一种替换加密技术，据传由古罗马军事领袖凯撒使用，通过将字母按照固定位置进行偏移来实现加密。</p>
                <p>例如，当密钥为3时：</p>
                <p>原文: A B C D ... X Y Z</p>
                <p>密文: D E F G ... A B C</p>
                <p>在二战期间，这种简单的加密方式被用于低级机密通信，通常与其他加密方法结合使用。</p>
            </div>
        </div>
    </div>
    
    <!-- 恩尼格玛密码机工具 -->
    <div class="tool-container" id="enigma-tool">
        <button class="back-btn" id="enigma-back-btn">返回</button>
        <div class="tool-header">
            <h2 class="tool-title">恩尼格玛密码机</h2>
            <p class="tool-subtitle">德国国防军Enigma I型模拟器</p>
        </div>
        
        <div class="enigma-rotors-section">
            <div class="enigma-rotors-title">转子设置</div>
            <div class="enigma-rotors-container">
                <div class="enigma-rotor">
                    <div class="enigma-rotor-label">转子 I</div>
                    <div class="enigma-rotor-display" id="enigma-rotor1">A</div>
                    <div class="enigma-rotor-controls">
                        <button class="enigma-rotor-btn" data-rotor="1" data-direction="-1">-</button>
                        <button class="enigma-rotor-btn" data-rotor="1" data-direction="1">+</button>
                    </div>
                </div>
                <div class="enigma-rotor">
                    <div class="enigma-rotor-label">转子 II</div>
                    <div class="enigma-rotor-display" id="enigma-rotor2">A</div>
                    <div class="enigma-rotor-controls">
                        <button class="enigma-rotor-btn" data-rotor="2" data-direction="-1">-</button>
                        <button class="enigma-rotor-btn" data-rotor="2" data-direction="1">+</button>
                    </div>
                </div>
                <div class="enigma-rotor">
                    <div class="enigma-rotor-label">转子 III</div>
                    <div class="enigma-rotor-display" id="enigma-rotor3">A</div>
                    <div class="enigma-rotor-controls">
                        <button class="enigma-rotor-btn" data-rotor="3" data-direction="-1">-</button>
                        <button class="enigma-rotor-btn" data-rotor="3" data-direction="1">+</button>
                    </div>
                </div>
            </div>
            <div class="enigma-status" id="enigma-rotor-status">转子位置: I-A, II-A, III-A</div>
        </div>
        
        <div class="enigma-plugboard-section">
            <div class="enigma-plugboard-title">插线板</div>
            <div class="enigma-plugboard">
                <div class="enigma-plug">
                    <div class="enigma-plug-letter">A</div>
                    <div class="enigma-plug-cable"></div>
                    <div class="enigma-plug-letter">B</div>
                </div>
                <div class="enigma-plug">
                    <div class="enigma-plug-letter">C</div>
                    <div class="enigma-plug-cable"></div>
                    <div class="enigma-plug-letter">D</div>
                </div>
                <div class="enigma-plug">
                    <div class="enigma-plug-letter">E</div>
                    <div class="enigma-plug-cable"></div>
                    <div class="enigma-plug-letter">F</div>
                </div>
                <div class="enigma-plug">
                    <div class="enigma-plug-letter">G</div>
                    <div class="enigma-plug-cable"></div>
                    <div class="enigma-plug-letter">H</div>
                </div>
                <div class="enigma-plug">
                    <div class="enigma-plug-letter">I</div>
                    <div class="enigma-plug-cable"></div>
                    <div class="enigma-plug-letter">J</div>
                </div>
            </div>
            <div class="enigma-status">插线板连接: A-B, C-D, E-F, G-H, I-J</div>
        </div>
        
        <div class="enigma-keyboard-lampboard">
            <div class="enigma-lampboard">
                <div class="enigma-section-title">灯盘</div>
                <div class="enigma-lamp-grid" id="enigma-lamp-grid">
                    <!-- 灯盘将通过JavaScript生成 -->
                </div>
            </div>
            
            <div class="enigma-keyboard">
                <div class="enigma-section-title">键盘</div>
                <div class="enigma-key-grid" id="enigma-key-grid">
                    <!-- 键盘将通过JavaScript生成 -->
                </div>
            </div>
        </div>
        
        <div class="enigma-input-output">
            <div class="enigma-input-area">
                <div class="enigma-section-title">输入</div>
                <textarea id="enigma-input-text" class="enigma-textarea" placeholder="输入要加密的文本..."></textarea>
                <div class="enigma-controls">
                    <button class="enigma-btn" id="enigma-encrypt-btn">加密文本</button>
                    <button class="enigma-btn" id="enigma-clear-input-btn">清除</button>
                </div>
            </div>
            
            <div class="enigma-output-area">
                <div class="enigma-section-title">输出</div>
                <textarea id="enigma-output-text" class="enigma-textarea" placeholder="加密结果将显示在这里..." readonly></textarea>
                <div class="enigma-controls">
                    <button class="enigma-btn" id="enigma-decrypt-btn">解密文本</button>
                    <button class="enigma-btn" id="enigma-clear-output-btn">清除</button>
                </div>
            </div>
        </div>
        
        <div class="enigma-history">
            <div class="enigma-history-title">加密历史</div>
            <div id="enigma-history-list">
                <!-- 历史记录将通过JavaScript生成 -->
            </div>
        </div>
    </div>
    
    <!-- 新增特工任务工具 -->
    <div class="mission-container" id="mission-tool">
        <button class="back-btn" id="mission-back-btn">返回</button>
        <div class="tool-header">
            <h2 class="tool-title">特工任务</h2>
            <p class="tool-subtitle">18关密码破译挑战 - 证明你的特工技能</p>
        </div>
        
        <div class="mission-tabs">
            <div class="mission-tab active" data-tab="levels">关卡选择</div>
            <div class="mission-tab" data-tab="certificate">毕业证书</div>
        </div>
        
        <div class="mission-tab-content active" id="mission-levels-tab">
            <div class="progress-text">任务进度: <span id="mission-progress-text">0/18</span></div>
            <div class="progress-bar">
                <div class="progress-fill" id="mission-progress-fill" style="width: 0%"></div>
            </div>
            
            <div class="mission-levels-grid" id="mission-levels-grid">
                <!-- 关卡将通过JavaScript生成 -->
            </div>
            
            <div class="mission-details" id="mission-details">
                <div class="mission-details-title">选择关卡开始任务</div>
                <div class="mission-details-description">
                    点击左侧的关卡卡片查看任务详情并开始挑战。每完成一个关卡，下一个关卡将自动解锁。
                </div>
            </div>
        </div>
        
        <div class="mission-tab-content" id="mission-certificate-tab">
            <div class="certificate-container" id="certificate-container">
                <div class="certificate-title">特工毕业证书</div>
                <div class="certificate-subtitle">少年特工密码破译专家</div>
                
                <div class="certificate-content">
                    兹证明 <strong id="certificate-agent-name">[特工姓名]</strong> 已完成全部18项密码破译任务，<br>
                    展现了卓越的密码学技能和特工素质，<br>
                    特授予此证书以资表彰。
                </div>
                
                <div class="certificate-seal">
                    少年特工
                </div>
                
                <div class="certificate-content">
                    颁发日期: <span id="certificate-date">[日期]</span><br>
                    证书编号: <span id="certificate-id">[编号]</span>
                </div>
                
                <button class="certificate-download" id="certificate-download-btn">下载证书</button>
            </div>
            
            <div class="mission-details" id="certificate-locked">
                <div class="mission-details-title">毕业证书尚未解锁</div>
                <div class="mission-details-description">
                    完成全部18个特工任务后，你将获得少年特工毕业证书。<br>
                    继续努力，证明你的密码破译能力！
                </div>
            </div>
        </div>
    </div>

    <script>
        // 页面导航功能
        const mainPage = document.getElementById('main-page');
        const morseTool = document.getElementById('morse-tool');
        const caesarTool = document.getElementById('caesar-tool');
        const enigmaTool = document.getElementById('enigma-tool');
        const missionTool = document.getElementById('mission-tool');
        
        const morseBtn = document.getElementById('morse-btn');
        const caesarBtn = document.getElementById('caesar-btn');
        const enigmaBtn = document.getElementById('enigma-btn');
        const missionBtn = document.getElementById('mission-btn');
        
        const morseBackBtn = document.getElementById('morse-back-btn');
        const caesarBackBtn = document.getElementById('caesar-back-btn');
        const enigmaBackBtn = document.getElementById('enigma-back-btn');
        const missionBackBtn = document.getElementById('mission-back-btn');
        
        // 显示指定工具，隐藏其他
        function showTool(tool) {
            mainPage.style.display = 'none';
            morseTool.classList.remove('active');
            caesarTool.classList.remove('active');
            enigmaTool.classList.remove('active');
            missionTool.classList.remove('active');
            
            if (tool === 'morse') {
                morseTool.classList.add('active');
            } else if (tool === 'caesar') {
                caesarTool.classList.add('active');
            } else if (tool === 'enigma') {
                enigmaTool.classList.add('active');
            } else if (tool === 'mission') {
                missionTool.classList.add('active');
                // 初始化任务系统
                initMissions();
            }
        }
        
        // 返回主页面
        function backToMain() {
            mainPage.style.display = 'flex';
            morseTool.classList.remove('active');
            caesarTool.classList.remove('active');
            enigmaTool.classList.remove('active');
            missionTool.classList.remove('active');
        }
        
        // 添加事件监听器
        morseBtn.addEventListener('click', () => showTool('morse'));
        caesarBtn.addEventListener('click', () => showTool('caesar'));
        enigmaBtn.addEventListener('click', () => showTool('enigma'));
        missionBtn.addEventListener('click', () => showTool('mission'));
        
        morseBackBtn.addEventListener('click', backToMain);
        caesarBackBtn.addEventListener('click', backToMain);
        enigmaBackBtn.addEventListener('click', backToMain);
        missionBackBtn.addEventListener('click', backToMain);
        
        // 添加键盘快捷键支持
        document.addEventListener('keydown', function(event) {
            if (mainPage.style.display !== 'none') {
                switch(event.key) {
                    case '1':
                        morseBtn.click();
                        break;
                    case '2':
                        caesarBtn.click();
                        break;
                    case '3':
                        enigmaBtn.click();
                        break;
                    case '4':
                        missionBtn.click();
                        break;
                }
            }
        });
        
        // 摩斯电码功能
        const morseCodeMap = {
            'A': '.-', 'B': '-...', 'C': '-.-.', 'D': '-..', 'E': '.', 'F': '..-.', 
            'G': '--.', 'H': '....', 'I': '..', 'J': '.---', 'K': '-.-', 'L': '.-..', 
            'M': '--', 'N': '-.', 'O': '---', 'P': '.--.', 'Q': '--.-', 'R': '.-.', 
            'S': '...', 'T': '-', 'U': '..-', 'V': '...-', 'W': '.--', 'X': '-..-', 
            'Y': '-.--', 'Z': '--..', '0': '-----', '1': '.----', '2': '..---', 
            '3': '...--', '4': '....-', '5': '.....', '6': '-....', '7': '--...', 
            '8': '---..', '9': '----.', '.': '.-.-.-', ',': '--..--', '?': '..--..', 
            "'": '.----.', '!': '-.-.--', '/': '-..-.', '(': '-.--.', ')': '-.--.-', 
            '&': '.-...', ':': '---...', ';': '-.-.-.', '=': '-...-', '+': '.-.-.', 
            '-': '-....-', '_': '..--.-', '"': '.-..-.', '$': '...-..-', '@': '.--.-.',
            ' ': '/'
        };

        // 摩斯电码DOM元素
        const morseTextInput = document.getElementById('morse-text-input');
        const morseOutput = document.getElementById('morse-output');
        const morseConvertBtn = document.getElementById('morse-convert-btn');
        const morsePlayBtn = document.getElementById('morse-play-btn');
        const morseClearBtn = document.getElementById('morse-clear-btn');
        const morseReferenceGrid = document.getElementById('morse-reference-grid');
        const morseSoundIndicator = document.querySelector('.morse-sound-indicator');

        // 音频上下文
        let morseAudioContext;
        let morseIsPlaying = false;
        let morseCurrentOscillator = null;

        // 初始化摩斯电码参考表
        function initMorseReferenceTable() {
            for (const [char, code] of Object.entries(morseCodeMap)) {
                const item = document.createElement('div');
                item.className = 'morse-reference-item';
                item.innerHTML = `<div class="morse-char">${char}</div><div class="morse-code">${code}</div>`;
                morseReferenceGrid.appendChild(item);
            }
        }

        // 文本转换为摩斯电码
        function textToMorse(text) {
            return text.toUpperCase().split('').map(char => {
                return morseCodeMap[char] || '';
            }).join(' ');
        }

        // 摩斯电码转换按钮点击事件
        morseConvertBtn.addEventListener('click', () => {
            const text = morseTextInput.value;
            const morse = textToMorse(text);
            morseOutput.textContent = morse;
            morseOutput.classList.add('morse-flash');
            setTimeout(() => morseOutput.classList.remove('morse-flash'), 500);
        });

        // 摩斯电码清除按钮点击事件
        morseClearBtn.addEventListener('click', () => {
            morseTextInput.value = '';
            morseOutput.textContent = '';
            if (morseIsPlaying) {
                stopMorseSound();
            }
        });

        // 播放摩斯电码声音
        function playMorseSound(morse) {
            if (!morseAudioContext) {
                morseAudioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            
            morseIsPlaying = true;
            morseSoundIndicator.classList.add('active');
            morsePlayBtn.disabled = true;
            
            const dotDuration = 100; // 点的时间（毫秒）
            const dashDuration = dotDuration * 3; // 划的时间
            const symbolGap = dotDuration; // 符号间隔
            const letterGap = dotDuration * 3; // 字母间隔
            const wordGap = dotDuration * 7; // 单词间隔
            
            let time = morseAudioContext.currentTime;
            
            morse.split('').forEach(symbol => {
                switch(symbol) {
                    case '.':
                        // 播放点
                        playMorseBeep(time, dotDuration);
                        time += dotDuration / 1000 + symbolGap / 1000;
                        break;
                    case '-':
                        // 播放划
                        playMorseBeep(time, dashDuration);
                        time += dashDuration / 1000 + symbolGap / 1000;
                        break;
                    case ' ':
                        // 字母间隔
                        time += (letterGap - symbolGap) / 1000;
                        break;
                    case '/':
                        // 单词间隔
                        time += (wordGap - symbolGap) / 1000;
                        break;
                }
            });
            
            // 播放完成后重置按钮状态
            setTimeout(() => {
                morseIsPlaying = false;
                morseSoundIndicator.classList.remove('active');
                morsePlayBtn.disabled = false;
            }, time * 1000 - morseAudioContext.currentTime * 1000 + 100);
        }

        // 播放摩斯电码单音
        function playMorseBeep(startTime, duration) {
            const oscillator = morseAudioContext.createOscillator();
            const gainNode = morseAudioContext.createGain();
            
            oscillator.connect(gainNode);
            gainNode.connect(morseAudioContext.destination);
            
            oscillator.frequency.value = 700; // 频率
            oscillator.type = 'sine'; // 波形
            
            gainNode.gain.setValueAtTime(0.3, startTime);
            gainNode.gain.exponentialRampToValueAtTime(0.01, startTime + duration / 1000);
            
            oscillator.start(startTime);
            oscillator.stop(startTime + duration / 1000);
            
            morseCurrentOscillator = oscillator;
        }

        // 停止播放摩斯电码声音
        function stopMorseSound() {
            if (morseCurrentOscillator) {
                morseCurrentOscillator.stop();
                morseCurrentOscillator = null;
            }
            morseIsPlaying = false;
            morseSoundIndicator.classList.remove('active');
            morsePlayBtn.disabled = false;
        }

        // 摩斯电码播放按钮点击事件
        morsePlayBtn.addEventListener('click', () => {
            if (morseIsPlaying) {
                stopMorseSound();
            } else {
                const morse = morseOutput.textContent;
                if (morse) {
                    playMorseSound(morse);
                }
            }
        });

        // 初始化摩斯电码
        document.addEventListener('DOMContentLoaded', () => {
            initMorseReferenceTable();
            
            // 输入时实时转换
            morseTextInput.addEventListener('input', () => {
                const text = morseTextInput.value;
                const morse = textToMorse(text);
                morseOutput.textContent = morse;
            });
        });
        
        // 凯撒密码功能
        // 凯撒密码DOM元素
        const caesarTabs = document.querySelectorAll('.caesar-tab');
        const caesarTabContents = document.querySelectorAll('.caesar-tab-content');
        const caesarPlaintextInput = document.getElementById('caesar-plaintext');
        const caesarCiphertextInput = document.getElementById('caesar-ciphertext');
        const caesarEncryptKeyInput = document.getElementById('caesar-encrypt-key');
        const caesarDecryptKeyInput = document.getElementById('caesar-decrypt-key');
        const caesarCiphertextOutput = document.getElementById('caesar-ciphertext-output');
        const caesarPlaintextOutput = document.getElementById('caesar-plaintext-output');
        const caesarEncryptBtn = document.getElementById('caesar-encrypt-btn');
        const caesarDecryptBtn = document.getElementById('caesar-decrypt-btn');
        const caesarCopyEncryptBtn = document.getElementById('caesar-copy-encrypt-btn');
        const caesarCopyDecryptBtn = document.getElementById('caesar-copy-decrypt-btn');
        const caesarClearEncryptBtn = document.getElementById('caesar-clear-encrypt-btn');
        const caesarClearDecryptBtn = document.getElementById('caesar-clear-decrypt-btn');

        // 凯撒密码标签切换功能
        caesarTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // 移除所有标签和内容的active类
                caesarTabs.forEach(t => t.classList.remove('active'));
                caesarTabContents.forEach(content => content.classList.remove('active'));
                
                // 添加当前标签和内容的active类
                tab.classList.add('active');
                document.getElementById(`caesar-${tabId}-tab`).classList.add('active');
            });
        });

        // 凯撒密码加密函数
        function caesarEncrypt(text, key) {
            key = parseInt(key) % 26;
            if (key === 0) return text;
            
            return text.split('').map(char => {
                if (char.match(/[a-z]/i)) {
                    const code = char.charCodeAt(0);
                    const isUpperCase = (code >= 65 && code <= 90);
                    const base = isUpperCase ? 65 : 97;
                    
                    // 应用凯撒移位
                    let shiftedCode = ((code - base + key) % 26) + base;
                    if (shiftedCode < base) shiftedCode += 26;
                    
                    return String.fromCharCode(shiftedCode);
                }
                return char;
            }).join('');
        }

        // 凯撒密码解密函数
        function caesarDecrypt(text, key) {
            key = parseInt(key) % 26;
            if (key === 0) return text;
            
            return text.split('').map(char => {
                if (char.match(/[a-z]/i)) {
                    const code = char.charCodeAt(0);
                    const isUpperCase = (code >= 65 && code <= 90);
                    const base = isUpperCase ? 65 : 97;
                    
                    // 应用凯撒移位（反向）
                    let shiftedCode = ((code - base - key) % 26) + base;
                    if (shiftedCode < base) shiftedCode += 26;
                    
                    return String.fromCharCode(shiftedCode);
                }
                return char;
            }).join('');
        }

        // 凯撒密码加密按钮点击事件
        caesarEncryptBtn.addEventListener('click', () => {
            const text = caesarPlaintextInput.value;
            const key = caesarEncryptKeyInput.value;
            
            if (!text) {
                caesarCiphertextOutput.textContent = "请输入要加密的文本";
                return;
            }
            
            if (key < 1 || key > 25) {
                caesarCiphertextOutput.textContent = "密钥必须是1到25之间的整数";
                return;
            }
            
            const encrypted = caesarEncrypt(text, key);
            caesarCiphertextOutput.textContent = encrypted;
            caesarCiphertextOutput.classList.add('caesar-flash');
            setTimeout(() => caesarCiphertextOutput.classList.remove('caesar-flash'), 500);
        });

        // 凯撒密码解密按钮点击事件
        caesarDecryptBtn.addEventListener('click', () => {
            const text = caesarCiphertextInput.value;
            const key = caesarDecryptKeyInput.value;
            
            if (!text) {
                caesarPlaintextOutput.textContent = "请输入要解密的文本";
                return;
            }
            
            if (key < 1 || key > 25) {
                caesarPlaintextOutput.textContent = "密钥必须是1到25之间的整数";
                return;
            }
            
            const decrypted = caesarDecrypt(text, key);
            caesarPlaintextOutput.textContent = decrypted;
            caesarPlaintextOutput.classList.add('caesar-flash');
            setTimeout(() => caesarPlaintextOutput.classList.remove('caesar-flash'), 500);
        });

        // 凯撒密码复制加密结果
        caesarCopyEncryptBtn.addEventListener('click', () => {
            const text = caesarCiphertextOutput.textContent;
            if (text && text !== "请输入要加密的文本" && text !== "密钥必须是1到25之间的整数") {
                navigator.clipboard.writeText(text).then(() => {
                    const originalText = caesarCopyEncryptBtn.textContent;
                    caesarCopyEncryptBtn.textContent = "已复制!";
                    setTimeout(() => {
                        caesarCopyEncryptBtn.textContent = originalText;
                    }, 2000);
                });
            }
        });

        // 凯撒密码复制解密结果
        caesarCopyDecryptBtn.addEventListener('click', () => {
            const text = caesarPlaintextOutput.textContent;
            if (text && text !== "请输入要解密的文本" && text !== "密钥必须是1到25之间的整数") {
                navigator.clipboard.writeText(text).then(() => {
                    const originalText = caesarCopyDecryptBtn.textContent;
                    caesarCopyDecryptBtn.textContent = "已复制!";
                    setTimeout(() => {
                        caesarCopyDecryptBtn.textContent = originalText;
                    }, 2000);
                });
            }
        });

        // 凯撒密码清除加密区域
        caesarClearEncryptBtn.addEventListener('click', () => {
            caesarPlaintextInput.value = '';
            caesarCiphertextOutput.textContent = '';
            caesarEncryptKeyInput.value = '3';
        });

        // 凯撒密码清除解密区域
        caesarClearDecryptBtn.addEventListener('click', () => {
            caesarCiphertextInput.value = '';
            caesarPlaintextOutput.textContent = '';
            caesarDecryptKeyInput.value = '3';
        });

        // 凯撒密码实时加密（可选功能）
        caesarPlaintextInput.addEventListener('input', () => {
            const text = caesarPlaintextInput.value;
            const key = caesarEncryptKeyInput.value;
            
            if (text && key >= 1 && key <= 25) {
                const encrypted = caesarEncrypt(text, key);
                caesarCiphertextOutput.textContent = encrypted;
            } else if (!text) {
                caesarCiphertextOutput.textContent = '';
            }
        });

        // 凯撒密码实时解密（可选功能）
        caesarCiphertextInput.addEventListener('input', () => {
            const text = caesarCiphertextInput.value;
            const key = caesarDecryptKeyInput.value;
            
            if (text && key >= 1 && key <= 25) {
                const decrypted = caesarDecrypt(text, key);
                caesarPlaintextOutput.textContent = decrypted;
            } else if (!text) {
                caesarPlaintextOutput.textContent = '';
            }
        });
        
        // 恩尼格玛密码机功能
        // 恩尼格玛机模拟
        class EnigmaMachine {
            constructor() {
                // 转子接线配置 (历史准确的恩尼格玛I型转子)
                this.rotorWirings = [
                    "EKMFLGDQVZNTOWYHXUSPAIBRCJ", // 转子I
                    "AJDKSIRUXBLHWTMCQGZNPYFVOE", // 转子II
                    "BDFHJLCPRTXVZNYEIWGAKMUSQO", // 转子III
                ];
                
                // 反射器接线 (历史准确的恩尼格玛UKW-B)
                this.reflectorWiring = "YRUHQSLDPXNGOKMIEBFZCWVJAT";
                
                // 插线板连接
                this.plugboard = {
                    'A': 'B', 'B': 'A',
                    'C': 'D', 'D': 'C',
                    'E': 'F', 'F': 'E',
                    'G': 'H', 'H': 'G',
                    'I': 'J', 'J': 'I'
                };
                
                // 转子当前位置
                this.rotorPositions = [0, 0, 0]; // A, A, A
                
                // 字母表
                this.alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            }
            
            // 设置转子位置
            setRotorPosition(rotorIndex, position) {
                this.rotorPositions[rotorIndex] = position % 26;
            }
            
            // 转动转子
            rotateRotors() {
                // 第一个转子每次按键都转动
                this.rotorPositions[0] = (this.rotorPositions[0] + 1) % 26;
                
                // 当第一个转子完成一圈时，转动第二个转子
                if (this.rotorPositions[0] === 0) {
                    this.rotorPositions[1] = (this.rotorPositions[1] + 1) % 26;
                    
                    // 当第二个转子完成一圈时，转动第三个转子
                    if (this.rotorPositions[1] === 0) {
                        this.rotorPositions[2] = (this.rotorPositions[2] + 1) % 26;
                    }
                }
            }
            
            // 通过插线板
            passThroughPlugboard(letter) {
                return this.plugboard[letter] || letter;
            }
            
            // 通过转子 (正向)
            passThroughRotor(letter, rotorIndex, forward) {
                const rotorWiring = this.rotorWirings[rotorIndex];
                const position = this.rotorPositions[rotorIndex];
                
                if (forward) {
                    // 输入字母在字母表中的位置
                    const inputIndex = this.alphabet.indexOf(letter);
                    // 考虑转子位置偏移
                    const shiftedIndex = (inputIndex + position) % 26;
                    // 通过转子接线
                    const outputLetter = rotorWiring[shiftedIndex];
                    // 反向偏移
                    const outputIndex = (this.alphabet.indexOf(outputLetter) - position + 26) % 26;
                    return this.alphabet[outputIndex];
                } else {
                    // 反向通过转子
                    const inputIndex = this.alphabet.indexOf(letter);
                    // 考虑转子位置偏移
                    const shiftedIndex = (inputIndex + position) % 26;
                    // 找到转子接线中的位置
                    const wiringIndex = rotorWiring.indexOf(this.alphabet[shiftedIndex]);
                    // 反向偏移
                    const outputIndex = (wiringIndex - position + 26) % 26;
                    return this.alphabet[outputIndex];
                }
            }
            
            // 通过反射器
            passThroughReflector(letter) {
                const index = this.alphabet.indexOf(letter);
                return this.reflectorWiring[index];
            }
            
            // 加密/解密单个字母
            processLetter(letter) {
                if (!this.alphabet.includes(letter)) return letter;
                
                // 转动转子
                this.rotateRotors();
                
                // 通过插线板 (输入)
                let currentLetter = this.passThroughPlugboard(letter);
                
                // 通过三个转子 (正向)
                for (let i = 0; i < 3; i++) {
                    currentLetter = this.passThroughRotor(currentLetter, i, true);
                }
                
                // 通过反射器
                currentLetter = this.passThroughReflector(currentLetter);
                
                // 通过三个转子 (反向)
                for (let i = 2; i >= 0; i--) {
                    currentLetter = this.passThroughRotor(currentLetter, i, false);
                }
                
                // 通过插线板 (输出)
                currentLetter = this.passThroughPlugboard(currentLetter);
                
                return currentLetter;
            }
            
            // 加密文本
            encrypt(text) {
                let result = "";
                for (let char of text.toUpperCase()) {
                    if (this.alphabet.includes(char)) {
                        result += this.processLetter(char);
                    } else {
                        result += char;
                    }
                }
                return result;
            }
            
            // 解密文本 (恩尼格玛是对称的，加密和解密使用相同的过程)
            decrypt(text) {
                return this.encrypt(text);
            }
        }

        // 恩尼格玛机DOM元素
        const enigma = new EnigmaMachine();
        const enigmaLampGrid = document.getElementById('enigma-lamp-grid');
        const enigmaKeyGrid = document.getElementById('enigma-key-grid');
        const enigmaInputText = document.getElementById('enigma-input-text');
        const enigmaOutputText = document.getElementById('enigma-output-text');
        const enigmaEncryptBtn = document.getElementById('enigma-encrypt-btn');
        const enigmaDecryptBtn = document.getElementById('enigma-decrypt-btn');
        const enigmaClearInputBtn = document.getElementById('enigma-clear-input-btn');
        const enigmaClearOutputBtn = document.getElementById('enigma-clear-output-btn');
        const enigmaRotorDisplays = [
            document.getElementById('enigma-rotor1'),
            document.getElementById('enigma-rotor2'),
            document.getElementById('enigma-rotor3')
        ];
        const enigmaRotorStatus = document.getElementById('enigma-rotor-status');
        const enigmaHistoryList = document.getElementById('enigma-history-list');

        // 初始化恩尼格玛机灯盘和键盘
        function initEnigmaLampsAndKeys() {
            const alphabet = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
            
            // 创建灯盘
            for (let letter of alphabet) {
                const lamp = document.createElement('div');
                lamp.className = 'enigma-lamp';
                lamp.textContent = letter;
                lamp.id = `enigma-lamp-${letter}`;
                enigmaLampGrid.appendChild(lamp);
            }
            
            // 创建键盘
            for (let letter of alphabet) {
                const key = document.createElement('div');
                key.className = 'enigma-key';
                key.textContent = letter;
                key.id = `enigma-key-${letter}`;
                key.addEventListener('click', () => handleEnigmaKeyPress(letter));
                enigmaKeyGrid.appendChild(key);
            }
        }

        // 处理恩尼格玛机按键
        function handleEnigmaKeyPress(letter) {
            // 高亮按键
            const key = document.getElementById(`enigma-key-${letter}`);
            key.classList.add('pressed');
            setTimeout(() => key.classList.remove('pressed'), 200);
            
            // 处理字母
            const result = enigma.processLetter(letter);
            
            // 点亮对应的灯
            const lamp = document.getElementById(`enigma-lamp-${result}`);
            lamp.classList.add('active');
            setTimeout(() => lamp.classList.remove('active'), 500);
            
            // 添加到历史记录
            addToEnigmaHistory(letter, result);
            
            // 更新转子状态显示
            updateEnigmaRotorStatus();
        }

        // 添加到恩尼格玛机历史记录
        function addToEnigmaHistory(input, output) {
            const historyItem = document.createElement('div');
            historyItem.className = 'enigma-history-item';
            historyItem.innerHTML = `<span class="enigma-input-char">${input}</span> → <span class="enigma-output-char">${output}</span>`;
            enigmaHistoryList.appendChild(historyItem);
            
            // 滚动到底部
            enigmaHistoryList.scrollTop = enigmaHistoryList.scrollHeight;
        }

        // 更新恩尼格玛机转子状态显示
        function updateEnigmaRotorStatus() {
            const positions = enigma.rotorPositions;
            const letters = positions.map(pos => String.fromCharCode(65 + pos));
            
            enigmaRotorDisplays[0].textContent = letters[0];
            enigmaRotorDisplays[1].textContent = letters[1];
            enigmaRotorDisplays[2].textContent = letters[2];
            
            enigmaRotorStatus.textContent = `转子位置: I-${letters[0]}, II-${letters[1]}, III-${letters[2]}`;
        }

        // 恩尼格玛机转子控制按钮事件
        document.querySelectorAll('.enigma-rotor-btn').forEach(button => {
            button.addEventListener('click', () => {
                const rotorIndex = parseInt(button.getAttribute('data-rotor')) - 1;
                const direction = parseInt(button.getAttribute('data-direction'));
                
                let newPosition = enigma.rotorPositions[rotorIndex] + direction;
                if (newPosition < 0) newPosition = 25;
                if (newPosition > 25) newPosition = 0;
                
                enigma.setRotorPosition(rotorIndex, newPosition);
                updateEnigmaRotorStatus();
            });
        });

        // 恩尼格玛机加密按钮事件
        enigmaEncryptBtn.addEventListener('click', () => {
            const text = enigmaInputText.value;
            if (text) {
                const encrypted = enigma.encrypt(text);
                enigmaOutputText.value = encrypted;
                
                // 重置转子位置以便下次使用
                enigma.setRotorPosition(0, 0);
                enigma.setRotorPosition(1, 0);
                enigma.setRotorPosition(2, 0);
                updateEnigmaRotorStatus();
            }
        });

        // 恩尼格玛机解密按钮事件
        enigmaDecryptBtn.addEventListener('click', () => {
            const text = enigmaOutputText.value;
            if (text) {
                const decrypted = enigma.decrypt(text);
                enigmaInputText.value = decrypted;
                
                // 重置转子位置以便下次使用
                enigma.setRotorPosition(0, 0);
                enigma.setRotorPosition(1, 0);
                enigma.setRotorPosition(2, 0);
                updateEnigmaRotorStatus();
            }
        });

        // 恩尼格玛机清除按钮事件
        enigmaClearInputBtn.addEventListener('click', () => {
            enigmaInputText.value = '';
        });

        enigmaClearOutputBtn.addEventListener('click', () => {
            enigmaOutputText.value = '';
        });

        // 初始化恩尼格玛机
        document.addEventListener('DOMContentLoaded', () => {
            initEnigmaLampsAndKeys();
            updateEnigmaRotorStatus();
        });
        
        // 特工任务功能
        const missionLevelsGrid = document.getElementById('mission-levels-grid');
        const missionDetails = document.getElementById('mission-details');
        const missionProgressText = document.getElementById('mission-progress-text');
        const missionProgressFill = document.getElementById('mission-progress-fill');
        const missionTabs = document.querySelectorAll('.mission-tab');
        const missionTabContents = document.querySelectorAll('.mission-tab-content');
        const certificateContainer = document.getElementById('certificate-container');
        const certificateLocked = document.getElementById('certificate-locked');
        const certificateDownloadBtn = document.getElementById('certificate-download-btn');

        // 特工任务数据
        const missionData = [
            {
                id: 1,
                title: "摩斯入门",
                description: "将单词 'HELLO' 转换为摩斯电码，字母间隔一个空格。",
                type: "morse",
                answer: ".... . .-.. .-.. ---",
                unlocked: true
            },
            {
                id: 2,
                title: "凯撒初试",
                description: "使用凯撒密码（密钥为3）解密 'KHOOR'。",
                type: "caesar",
                answer: "HELLO",
                key: 3,
                unlocked: false
            },
            {
                id: 3,
                title: "恩尼格玛初探",
                description: "使用恩尼格玛机（转子位置AAA）加密字母 'A'。",
                type: "enigma",
                answer: "W",
                rotorPositions: [0, 0, 0],
                unlocked: false
            },
            {
                id: 4,
                title: "摩斯解密",
                description: "解密摩斯电码 \" --  ---  .-.  ... . \"",
                type: "morse",
                answer: "MORSE",
                unlocked: false
            },
            {
                id: 5,
                title: "凯撒加密",
                description: "使用凯撒密码（密钥为5）加密 'SECRET'。",
                type: "caesar",
                answer: "XJHWJY",
                key: 5,
                unlocked: false
            },
            {
                id: 6,
                title: "恩尼格玛消息",
                description: "使用恩尼格玛机（转子位置ABC）加密 'TEST'。",
                type: "enigma",
                answer: "DMIM",
                unlocked: false
            },
            {
                id: 7,
                title: "混合密码1",
                description: "先用凯撒密码（密钥7）加密 'AGENT'，再转换为摩斯电码。",
                type: "mixed",
                answer: ".... -. .-.. ..- .-",
                unlocked: false
            },
            {
                id: 8,
                title: "混合密码2",
                description: "解密摩斯电码 '-.-. .... ..- .-.'，然后使用凯撒密码（密钥3）解密结果。",
                type: "mixed",
                answer: "ZERO",
                unlocked: false
            },
            {
                id: 9,
                title: "恩尼格玛配置",
                description: "使用恩尼格玛机（转子位置XYZ）加密 'MESSAGE'。",
                type: "enigma",
                answer: "AZCPHQX",
                unlocked: false
            },
            {
                id: 10,
                title: "中级挑战1",
                description: "解密凯撒密码（密钥:1-5）'WKLV LV D PHVVDJH'。",
                type: "caesar",
                answer: "THIS IS A MESSAGE",
                key: 3,
                unlocked: false
            },
            {
                id: 11,
                title: "中级挑战2",
                description: "将 'ENCRYPTION' 转换为摩斯电码，字母间隔一个空格。",
                type: "morse",
                answer: ". -. -.-. .-. -.-- .--. - .. --- -.",
                unlocked: false
            },
            {
                id: 12,
                title: "恩尼格玛挑战",
                description: "使用恩尼格玛机（转子位置CCC）加密 'CHALLENGE'。",
                type: "enigma",
                answer: "GEEKHAARS",
                unlocked: false
            },
            {
                id: 13,
                title: "高级混合1",
                description: "先用恩尼格玛机（转子位置AAA）加密 'CODE'，再转换为摩斯电码。",
                type: "mixed",
                answer: "--- .-.. ...- -.-",
                unlocked: false
            },
            {
                id: 14,
                title: "高级混合2",
                description: "解密摩斯电码 '-.-. --- -- -... --- -..'，然后使用凯撒密码（密钥10）解密结果。",
                type: "mixed",
                answer: "SECRET",
                unlocked: false
            },
            {
                id: 15,
                title: "凯撒高级",
                description: "解密凯撒密码（密钥:2或3）'WHVW SDVV'。",
                type: "caesar",
                answer: "TEST PASS",
                key: 3,
                unlocked: false
            },
            {
                id: 16,
                title: "恩尼格玛高级",
                description: "使用恩尼格玛机（转子位置QWE）加密 'FINALTEST'。",
                type: "enigma",
                answer: "SORFEQYLQ",
                unlocked: false
            },
            {
                id: 17,
                title: "终极挑战1",
                description: "结合使用三种密码系统加密 'SPY'，凯撒加密7位，恩尼格玛机（转子位置AAA），转摩斯电码。",
                type: "mixed",
                answer: "- -. -",
                unlocked: false
            },
            {
                id: 18,
                title: "终极挑战2",
                description: "解密这个最终消息：'SUCCESS'先用凯撒密码（密钥13）解密，再用恩尼格玛机（转子位置AAA）解密，最后转换为摩斯电码。",
                type: "mixed",
                answer: "-.- -. ..-. ... --.. .. ---",
                unlocked: false
            }
        ];

        // 初始化特工任务
        function initMissions() {
            // 从本地存储加载任务进度
            const savedProgress = localStorage.getItem('missionProgress');
            if (savedProgress) {
                const progress = JSON.parse(savedProgress);
                missionData.forEach(mission => {
                    if (progress[mission.id]) {
                        mission.completed = progress[mission.id].completed;
                        mission.unlocked = progress[mission.id].unlocked;
                    }
                });
            } else {
                // 初始化任务状态
                missionData[0].unlocked = true;
                saveMissionProgress();
            }
            
            renderMissionLevels();
            updateMissionProgress();
        }

        // 渲染任务关卡
        function renderMissionLevels() {
            missionLevelsGrid.innerHTML = '';
            
            missionData.forEach(mission => {
                const levelElement = document.createElement('div');
                levelElement.className = 'mission-level';
                
                if (mission.completed) {
                    levelElement.classList.add('completed');
                } else if (mission.unlocked) {
                    levelElement.classList.add('unlocked');
                } else {
                    levelElement.classList.add('locked');
                }
                
                levelElement.innerHTML = `
                    <div class="mission-level-number">${mission.id}</div>
                    <div class="mission-level-title">${mission.title}</div>
                `;
                
                if (mission.unlocked) {
                    levelElement.addEventListener('click', () => showMissionDetails(mission));
                }
                
                missionLevelsGrid.appendChild(levelElement);
            });
        }

        // 显示任务详情
        function showMissionDetails(mission) {
            let missionHTML = `
                <div class="mission-details-title">任务 ${mission.id}: ${mission.title}</div>
                <div class="mission-details-description">${mission.description}</div>
            `;
            
            missionHTML += `
                <div class="mission-input-group">
                    <label for="mission-answer" class="mission-label">输入答案:</label>
                    <input type="text" id="mission-answer" class="mission-input" placeholder="输入你的答案...">
                </div>
                <div class="mission-controls">
                    <button class="mission-btn" id="mission-submit-btn">提交答案</button>
                    <button class="mission-btn" id="mission-reset-btn">重置</button>
                </div>
                <div class="mission-result" id="mission-result"></div>
            `;
            
            missionDetails.innerHTML = missionHTML;
            
            // 添加事件监听器
            document.getElementById('mission-submit-btn').addEventListener('click', () => checkMissionAnswer(mission));
            document.getElementById('mission-reset-btn').addEventListener('click', () => showMissionDetails(mission));
        }

        // 检查任务答案
        function checkMissionAnswer(mission) {
            const userAnswer = document.getElementById('mission-answer').value.trim().toUpperCase();
            const correctAnswer = mission.answer.toUpperCase();
            const resultElement = document.getElementById('mission-result');
            
            if (userAnswer === correctAnswer) {
                resultElement.textContent = "任务完成！答案正确！";
                resultElement.className = "mission-result success";
                
                // 标记任务为完成
                mission.completed = true;
                
                // 解锁下一个任务
                if (mission.id < missionData.length) {
                    missionData[mission.id].unlocked = true;
                }
                
                // 保存进度
                saveMissionProgress();
                
                // 更新UI
                renderMissionLevels();
                updateMissionProgress();
                
                // 检查是否所有任务都已完成
                checkAllMissionsCompleted();
            } else {
                resultElement.textContent = "答案不正确，请再试一次。";
                resultElement.className = "mission-result failure";
            }
        }

        // 保存任务进度
        function saveMissionProgress() {
            const progress = {};
            missionData.forEach(mission => {
                progress[mission.id] = {
                    completed: mission.completed || false,
                    unlocked: mission.unlocked || false
                };
            });
            localStorage.setItem('missionProgress', JSON.stringify(progress));
        }

        // 更新任务进度显示
        function updateMissionProgress() {
            const completedMissions = missionData.filter(mission => mission.completed).length;
            const totalMissions = missionData.length;
            const progressPercentage = (completedMissions / totalMissions) * 100;
            
            missionProgressText.textContent = `${completedMissions}/${totalMissions}`;
            missionProgressFill.style.width = `${progressPercentage}%`;
        }

        // 检查是否所有任务都已完成
        function checkAllMissionsCompleted() {
            const allCompleted = missionData.every(mission => mission.completed);
            
            if (allCompleted) {
                // 显示毕业证书
                showCertificate();
            }
        }

        // 显示毕业证书
        function showCertificate() {
            // 切换到证书标签
            missionTabs.forEach(tab => tab.classList.remove('active'));
            missionTabContents.forEach(content => content.classList.remove('active'));
            
            document.querySelector('.mission-tab[data-tab="certificate"]').classList.add('active');
            document.getElementById('mission-certificate-tab').classList.add('active');
            
            // 显示证书
            certificateContainer.classList.add('active');
            certificateLocked.style.display = 'none';
            
            // 设置证书内容
            const today = new Date();
            const formattedDate = `${today.getFullYear()}-${(today.getMonth()+1).toString().padStart(2, '0')}-${today.getDate().toString().padStart(2, '0')}`;
            const certificateId = `ST-${today.getTime().toString().substring(7)}`;
            
            document.getElementById('certificate-date').textContent = formattedDate;
            document.getElementById('certificate-id').textContent = certificateId;
            
            // 从本地存储获取特工姓名或提示输入
            let agentName = localStorage.getItem('agentName');
            if (!agentName) {
                agentName = prompt("恭喜你完成所有任务！请输入你的特工姓名：");
                if (agentName) {
                    localStorage.setItem('agentName', agentName);
                } else {
                    agentName = "匿名特工";
                }
            }
            document.getElementById('certificate-agent-name').textContent = agentName;
        }

        // 证书下载功能
        certificateDownloadBtn.addEventListener('click', () => {
            // 创建证书图像并下载
            alert("证书下载功能已触发！在实际应用中，这里会生成可下载的证书图像。");
        });

        // 特工任务标签切换
        missionTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const tabId = tab.getAttribute('data-tab');
                
                // 移除所有标签和内容的active类
                missionTabs.forEach(t => t.classList.remove('active'));
                missionTabContents.forEach(content => content.classList.remove('active'));
                
                // 添加当前标签和内容的active类
                tab.classList.add('active');
                document.getElementById(`mission-${tabId}-tab`).classList.add('active');
                
                // 如果切换到证书标签且未完成所有任务，显示锁定消息
                if (tabId === 'certificate') {
                    const allCompleted = missionData.every(mission => mission.completed);
                    if (allCompleted) {
                        certificateContainer.classList.add('active');
                        certificateLocked.style.display = 'none';
                    } else {
                        certificateContainer.classList.remove('active');
                        certificateLocked.style.display = 'block';
                    }
                }
            });
        });
    </script>
</body>
</html>
